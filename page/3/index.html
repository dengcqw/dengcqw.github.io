<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"dengcqw.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it&#39;s never too late.">
<meta property="og:type" content="website">
<meta property="og:title" content="Deng&#39;s Technique Blogs">
<meta property="og:url" content="https://dengcqw.github.io/page/3/index.html">
<meta property="og:site_name" content="Deng&#39;s Technique Blogs">
<meta property="og:description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it&#39;s never too late.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="DengJinlong">
<meta property="article:tag" content="计算机">
<meta property="article:tag" content="computer">
<meta property="article:tag" content="思考">
<meta property="article:tag" content="thinking">
<meta property="article:tag" content="移动互联网">
<meta property="article:tag" content="mobile internet">
<meta property="article:tag" content="软件">
<meta property="article:tag" content="Software">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dengcqw.github.io/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Deng's Technique Blogs</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Deng's Technique Blogs</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">邓小宝的技术博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">DengJinlong</p>
  <div class="site-description" itemprop="description">我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">29</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/18/work-daily-220718/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/18/work-daily-220718/" class="post-title-link" itemprop="url">work-daily-220718</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-18 09:19:32" itemprop="dateCreated datePublished" datetime="2022-07-18T09:19:32+08:00">2022-07-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-31 07:26:09" itemprop="dateModified" datetime="2022-07-31T07:26:09+08:00">2022-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><p>打了个测试包，花了10分钟。<br>昨晚打了个包，今天上发给测试同事，然后crash<br>“This app has crashed because it attempted to access privacy-sensitive data without a usage description.<br>The app’s Info.plist must contain an NSMicrophoneUsageDescription key with a string value explaining to the user how the app uses this data.”<br>“之前都测过了”，难道录音功能是刚添加上的？<br>我的测试机调试没崩溃，安装包也没崩溃，又是为什么呢？<br>又打了一个包，竟然没有把info修改带进去。又花了10多分钟。把ipa解压看看。确认没问题再上传。<br>但是没有NSMicrophoneUsageDescription，原来区分了debug和relase的info.plist<br><img src="/imgs/xcode_infoplist_setting.webp" alt="infoplist"><br>另一种方案是：使用shell脚本修改info.plist插入debug信息。</p>
<p>iPhone12 拍摄视频 720P视频，全屏显示有裁剪的问题。宽高比不一样了。<br>以屏幕宽度为基准，计算出等比例的高度, 做为显示区域，可以参考手机拍照App。</p>
<blockquote>
<p>iPhone 12&amp;Pro     390 x 844  1170 x 2532<br>iPhone 8 Plusx    414 × 736  1080 × 1920<br>iPhone 6          375 × 667  750 × 1334</p>
</blockquote>
<p>720P 定义: 720p is the standard high-definition (HD) display resolution of 1280x720 pixels, with progressive scanning, at a 16x9 aspect ratio.</p>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><ul>
<li><p>RN中使用 \n 换行符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Text&gt;</span><br><span class="line">  Hi&#123;&#x27;\n&#x27;&#125;</span><br><span class="line">  This is a test message.</span><br><span class="line">&lt;/Text&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>props传递的string 中换行符 怎么处理?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">If the text comes from a prop,</span><br><span class="line">make sure you pass it like this: &lt;Component text=&#123;&quot;Line1\nLine2&quot;&#125; /&gt;</span><br><span class="line">instead of &lt;Component text=&quot;Line1\nLine2&quot; /&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>代码格式化是个费时的事，每次要敲很多空格。所以需要找个好工具。<br>jsx，tsx 是 js代码里混了xml。需要专门的工具吧<br>试试这个吧 <a target="_blank" rel="noopener" href="https://github.com/prettier/vim-prettier">vim-prettier</a><br>还有一个工具  <a target="_blank" rel="noopener" href="https://vimawesome.com/plugin/vim-jsx-pretty">VIM-JSX-PRETTY</a></p>
<p>ALE 也有Fix功能:  g:ale_fixers &amp; ALEFix</p>
<p>前同事说“文件上传成功了”，发了个包给测试，但测试就没开始测。文件地址是404。<br>我看了他的代码，用了一个api是头文件里有，但文档里没有。算是一个快捷api，但是没有文档。<br>我要花时间帮他完成剩余的工作了。 <a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/94411.html">OSS 文档</a></p>
<p>一个快餐一样(一次性)的需求，需要花精力吗？需要单元测试吗？需要solid吗？<br>雇主是怎么想？花最少的投资实现功能。至于界面之下的代码多么丑陋不重要，雇主又不看代码。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/15/work-daily-220715/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/15/work-daily-220715/" class="post-title-link" itemprop="url">work_daily_220715</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-15 09:33:36" itemprop="dateCreated datePublished" datetime="2022-07-15T09:33:36+08:00">2022-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-31 07:26:09" itemprop="dateModified" datetime="2022-07-31T07:26:09+08:00">2022-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><p>水印绘制优化<br>    iphone8p 水印超出了屏幕的原因<br>    3x手机上可以UIImage读取了3x图片。画布大小没改变时，绘制图片变大了,<br>    我把assects 中 3x图片放在1x位置上，然后删掉3x，绘制图片更大了。<br>    所以在CGContext上绘制图片和UIImage scale及图片大小都有关系。<br>    把2x图片放在3x位置，绘制正常些了</p>
<pre><code>今天一天都在调绘制的参数，基础不过关。但是学这些基础，要花很多时间。用的却不多。这是投入产出的问题。
如是不是为了性能，可以更快解决。
</code></pre>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><p>不需要使用CIFilter，有CIImage方法可以用 imageByCompositingOverImage</p>
<p>下面有区别吗？ 改scale， size会变吗? 显示时和屏幕scale有关。</p>
<blockquote>
<p>&lt;UIImage: 0x2803017a0&gt; size {360, 540} orientation 0 scale 2.000000, scale &#x3D; 2<br>&lt;UIImage: 0x2803017a0&gt; size {720, 1080} orientation 0 scale 1.000000, scale &#x3D; 1</p>
</blockquote>
<p>iOS UIScreen nativeScale 和 scale 不相等</p>
<p>录制频幕时没有保持屏幕高亮<br>需要UIApplication.shared.isIdleTimerDisabled &#x3D; true</p>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>今天面试了一个react开发，简历上写很多项目，公司也是没听过的，学历很差。明显是培训出来的。<br>面试时也是知道知道的，不知道不知道的。碎片化的知识。看不出什么工作经验。<br>虽然从大厂出来的人，不一定都行。怎样都比我今天面试的这类人强吧。</p>
<p>“努力工作不能使你升职，努力工作不能使你加薪”<br>我努力工作不为了升职，不为了加薪。只为快乐，只为提高自己。<br>对一个普通的我来说，有份工作干到退休就很不错了。</p>
<p>怎么查看我应用上传的视频? 管理后台没有入口，因为需要权限。同事帮忙加了权限。都在群里，大家还挺热心的。后期都要把这些内容写成文档，要写的内容挺多的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/14/work-daily-220714/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/14/work-daily-220714/" class="post-title-link" itemprop="url">work_daily_220714</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-14 09:33:36" itemprop="dateCreated datePublished" datetime="2022-07-14T09:33:36+08:00">2022-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-31 07:26:09" itemprop="dateModified" datetime="2022-07-31T07:26:09+08:00">2022-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><h4 id="视频拍摄实时水印"><a href="#视频拍摄实时水印" class="headerlink" title="视频拍摄实时水印"></a>视频拍摄实时水印</h4><h5 id="生成水印图片"><a href="#生成水印图片" class="headerlink" title="生成水印图片"></a>生成水印图片</h5><ul>
<li>方法一 使用UIKit<br>  CALayer 的方法renderInContext可以在CGContext绘制内容</li>
<li>方法二 使用CoreGraphic<br>  找了好就久，找到这个<a target="_blank" rel="noopener" href="https://juejin.cn/post/6856567623615217672">CGContext的变换过程详解</a>。CG是很老的东西了吗？<br>  直接使用NSString, UIImage的draw方法在CGContext上绘制<br>总结：方法一性能比方法二好，前者要0.01s-0.02s，后者稳定在0.01s以下</li>
</ul>
<h5 id="旋转图片"><a href="#旋转图片" class="headerlink" title="旋转图片"></a>旋转图片</h5><p>现在要旋转生成的图片，因为竖屏拍摄的视频内容是横屏的，通过断点调试查看图片发现的。</p>
<ul>
<li>尝试了UIView的transform属性，再生成图片，无效。</li>
<li>新建CGContext，设置 CGContextRotateCTM，再绘制图片（我觉得效率不高）</li>
<li>使用-[CIImage imageByApplyingOrientation] (效率高，真实图片并没旋转)</li>
<li>UIImage(cgImage:, scale:, orientation:) (好像只对UIKit有效，对CG无效)</li>
</ul>
<h5 id="性能验证"><a href="#性能验证" class="headerlink" title="性能验证"></a>性能验证</h5><p>拍摄时会一秒卡顿一次。 可能是生成水印的性能问题。<br>那把水印去掉看看。还真是这个性能问题。<br>render layer 要 0.01s-0.02s   直接绘制性能好些 0.01s以下<br>render layer + rotation 要  0.1s</p>
<p>最后选择 CoreGraphic绘制图片，再用CIImage 旋转图片</p>
<h5 id="合并图片"><a href="#合并图片" class="headerlink" title="合并图片"></a>合并图片</h5><p>使用-[CIImage imageByCompositingOverImage] 或CIFilter<br>这里有个多线程问题，设置水印的线程和读取水印的线程不样。<br>为了方式出现问题，使用了NSLock</p>
<h5 id="压缩输出视频"><a href="#压缩输出视频" class="headerlink" title="压缩输出视频"></a>压缩输出视频</h5><ul>
<li><p>可以设置AVCaptureSession 的 帧率，由30降到25</p>
</li>
<li><p>AVCaptureSessionPreset 可以修改设备拍摄的分辨率<br>  AVCaptureSessionPresetMedium（suitable for sharing over WiFi.）<br>  AVCaptureSessionPresetLow   （suitable for sharing over 3G.）<br>  AVCaptureSessionPreset960x540<br>  AVCaptureSessionPreset1280x720</p>
</li>
<li><p>输出视频的设置<br>找到一个库<a target="_blank" rel="noopener" href="https://github.com/SergeyPetrachkov/SwiftyVideoExporter">SwiftyVideoExporter</a>，其中就有通过设置Video Settings改变输出视频相关参数。<br>Video Settings 没有找到明确的文档说明，专业做视频的人可能知道参数的含义。<br>通过打印查看</p>
<pre><code>  &#123;
      AVVideoCodecKey = avc1;
      AVVideoCompressionPropertiesKey =     &#123;
          AverageBitRate = 8755200;
          ExpectedFrameRate = 25;
          MaxKeyFrameIntervalDuration = 1;
          Priority = 80;
          ProfileLevel = &quot;H264_Baseline_AutoLevel&quot;;
          RealTime = 1;
      &#125;;
      AVVideoHeightKey = 720;
      AVVideoWidthKey = 1280;
  &#125;
</code></pre>
<p>  等比例修改AVVideoHeightKey, AVVideoWidthKey 再传给AVAssetWriter可以实现视频压缩</p>
</li>
<li><p>视频大小优化结果<br>  1分钟 24M<br>  Video: h264 (Baseline) (avc1 &#x2F; 0x31637661), yuv420p(progressive), 1280x720, 3245 kb&#x2F;s, 25.01 fps, 25 tbr, 600 tbn (default)<br>  缩放后 1分钟 16M<br>  Video: h264 (High) (avc1 &#x2F; 0x31637661), yuv420p(tv, smpte170m&#x2F;bt709&#x2F;bt709, progressive), 330x588, 1358 kb&#x2F;s, 30.01 fps, 30 tbr, 600 tbn</p>
</li>
</ul>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><h4 id="UIViewController生命周期回调"><a href="#UIViewController生命周期回调" class="headerlink" title="UIViewController生命周期回调"></a>UIViewController生命周期回调</h4><p>let vc &#x3D; CaptureViewController()<br>调用vc.view 会触发viewWillAppear生命周期函数</p>
<h4 id="swift-绘制-string"><a href="#swift-绘制-string" class="headerlink" title="swift 绘制 string"></a>swift 绘制 string</h4><p>转成成NSString, 再使用draw 方法</p>
<h4 id="查看视频分辨率？"><a href="#查看视频分辨率？" class="headerlink" title="查看视频分辨率？"></a>查看视频分辨率？</h4><p>ffprobe -i video.flv<br>ffmpeg -i filename.flv</p>
<h4 id="调试CGCoreGraphic"><a href="#调试CGCoreGraphic" class="headerlink" title="调试CGCoreGraphic"></a>调试CGCoreGraphic</h4><p>CGContet 可以设置transform  修改坐标系<br>可是在draw之前设置，还是在draw之后呢？<br>CGContext 调试太难，有没有在线工具？</p>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>周五面试 RN开发 初中级开发</p>
<p>公司还是有些混乱。可以记录下来。编撰成册呢。</p>
<p>产品经理找我给需求评估开发时间，这个需求是用RN写的。有很多基础设施建设工作。我正忙于别的需求，明天再评估。</p>
<p>过程式代码，逻辑混乱，代码跳来跳去。有点抓狂。</p>
<p>swift 编译快了。我以前花了几天时间写的：只编译修改文件再link的工具没什么用了啦。但是调试还很慢。<br>Archive 了一下公司项目 App有240M。 ipa 68M。 直接压缩有100M。为什么呢</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/13/work-daily-220713/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/13/work-daily-220713/" class="post-title-link" itemprop="url">work_daily_220713</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-13 09:33:36" itemprop="dateCreated datePublished" datetime="2022-07-13T09:33:36+08:00">2022-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-24 16:06:18" itemprop="dateModified" datetime="2022-07-24T16:06:18+08:00">2022-07-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><h4 id="接手一个未完结的需求"><a href="#接手一个未完结的需求" class="headerlink" title="接手一个未完结的需求"></a>接手一个未完结的需求</h4><blockquote>
<p>准备接手其他同事的需求, swift原生开发<br>跑了一下项目，直接崩溃了<br>2022-07-13 12:30:04.144419+0800 [1212:651825] *** Assertion failure in -[GPUImageFramebuffer unlock], GPUImageFramebuffer.m:269<br>2022-07-13 12:30:04.148343+0800 [1212:651825] *** Terminating app due to uncaught exception ‘NSInternalInconsistencyException’, reason: ‘Tried to overrelease a framebuffer, did you forget to call -useNextFrameForImageCapture before using -imageFromCurrentFramebuffer?’</p>
<p>项目需要拍摄视频，并添加水印。然后GPUImage出现了。<br>我就问同事了，为什么用GPUImage，不用系统方法？这是面试官问我的。<br>这个库很老了，有些bug<br>我需要看看AVCaptureSession能不能实现类似功能。<br>网上资料较少。图片添加水印，可以使用CoreGraphic 在原图上绘制水印。<br>视频添加原理类似的吧。<br>如果可以拿到每一帧图片也就可以添加水印了。</p>
<p>找到一个教程<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903680555089927">-&gt;</a><br>这个教程是先拍视屏，然后拿拍摄好的视频添加水印。<br>我需求要实时添加水印。只能继续看官方文档或用英文搜搜看。</p>
<p>有人遇到同样的问题。肯定的。还是stackoverflow有用<br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/58909611/avcapturesession-add-multiple-outputs-in-parallel">avcapturesession-add-multiple-outputs-in-parallel</a><br>推荐方案：AVCaptureVideoDataOutput + AVAssetsWriter<br>这人还推荐了个<a target="_blank" rel="noopener" href="https://gist.github.com/yusuke024/b5cd3909d9d7f9e919291491f6b381f0?permalink_comment_id=4126877#gistcomment-4126877">demo</a><br>苹果文档里code sample 真是个大宝库。官方使用的也是上面的方案。图片处理方式 有CPU，GUP，CoreImage, openCV<br><a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html?language=swift#//apple_ref/doc/uid/TP30001185">CoreImage文档</a><br>还是先google搜下 “CIFilter 添加水印”，有些文章介绍这个的。放心了。<a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CISourceOverCompositing">CISourceOverCompositing</a><br>官方demo 上验证成功了。可以开始专心写需求了。</p>
</blockquote>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><h4 id="vim中jsx支持"><a href="#vim中jsx支持" class="headerlink" title="vim中jsx支持"></a>vim中jsx支持</h4><p>我使用vim遇到的问题是 jsx格式化做的不好<br><a target="_blank" rel="noopener" href="https://thoughtbot.com/blog/modern-typescript-and-react-development-in-vim">Modern TypeScript and React Development in Vim</a></p>
<h4 id="react-ts-code-snippet"><a href="#react-ts-code-snippet" class="headerlink" title="react+ts code snippet"></a>react+ts code snippet</h4><p>   <a target="_blank" rel="noopener" href="https://github.com/dsznajder/vscode-react-javascript-snippets/tree/185bb91a0b692c54136663464e8225872c434637">vscode-react-javascript-snippets</a><br>   <a target="_blank" rel="noopener" href="https://github.com/mlaursen/vim-react-snippets">vim-react-snippets</a><br>   <a target="_blank" rel="noopener" href="https://github.com/typescript-cheatsheets/react">react</a><br>   参考一下，还是需要整理的。改成自己熟悉的命名方法</p>
<h4 id="TypeScript-Deep-Dive"><a href="#TypeScript-Deep-Dive" class="headerlink" title="TypeScript Deep Dive"></a><a target="_blank" rel="noopener" href="https://jkchao.github.io/typescript-book-chinese/">TypeScript Deep Dive</a></h4><p>《TypeScript Deep Dive》 的中文翻译版<br>只能使用零碎时间阅读了，感谢作者。奇怪他们时间真多。</p>
<h4 id="react-native-elements"><a href="#react-native-elements" class="headerlink" title="react-native-elements"></a>react-native-elements</h4><p>有个库叫 react-native-elements，可以npm install 安装<br>但点开官网，又让安装 @rneui&#x2F;themed @rneui&#x2F;base<br>这几个到底什么关系？ 从版本号上看，react-native-elements被拆成两个包了。</p>
<h4 id="react-navigation"><a href="#react-navigation" class="headerlink" title="react-navigation"></a>react-navigation</h4><p>直接安装react-navigation，会使用4.4.4 版本, 请看官网安装指南<br>官网显示已经拆分成多个组件了, 6.x 版本了。各组件什么作用，需要看文档。</p>
<h4 id="react-native降级"><a href="#react-native降级" class="headerlink" title="react-native降级"></a>react-native降级</h4><p>react-native 0.69 最低支持iOS 12.4，所以我要使用0.68 版本，支持iOS 11<br>如何降低版本呢？再安装一次模板，然后看看package.json中的版本号。<br>npx react-native init –version 0.68 –skip-install testrn</p>
<h4 id="npm-检查依赖-gt"><a href="#npm-检查依赖-gt" class="headerlink" title="npm 检查依赖-&gt;"></a>npm 检查依赖<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/27955781">-&gt;</a></h4><p>npm install check-dependencies</p>
<p>react-shallow-renderer是测试相关的库，可以忽略<br>出现不匹配的情况，可能需要升级相关库了。</p>
<pre><code>npm WARN ERESOLVE overriding peer dependency
npm WARN While resolving: react-shallow-renderer@16.14.1
npm WARN Found: react@18.0.0
npm WARN node_modules/react
npm WARN   peer react@&quot;*&quot; from @react-navigation/core@3.7.9
npm WARN   node_modules/@react-navigation/core
npm WARN     @react-navigation/core@&quot;^3.7.9&quot; from react-navigation@4.4.4
npm WARN     node_modules/react-navigation
npm WARN   15 more (react-native-ratings, react-native, ...)

Could not resolve dependency:
npm WARN peer react@&quot;^17.0.0&quot; from react-freeze@1.0.0
npm WARN node_modules/react-native-screens/node_modules/react-freeze
npm WARN   react-freeze@&quot;^1.0.0&quot; from react-native-screens@3.15.0
npm WARN   node_modules/react-native-screens
</code></pre>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>培训视频里说，我们公司是一个很年轻的团队，26-30岁的员工占51%。谁能告诉我，这有什么用。代码写不好，项目做不好。</p>
<p>以前看过CoreImage 文档，所以接收同事需求后，大概知道怎么做了。如果是个新手，那他需要多少时间去学习这块知识呢。除了使用现成第三方库，可能无从下手。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/12/work-daily-220712/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/12/work-daily-220712/" class="post-title-link" itemprop="url">work_daily_220112</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-12 09:33:36" itemprop="dateCreated datePublished" datetime="2022-07-12T09:33:36+08:00">2022-07-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-24 16:06:18" itemprop="dateModified" datetime="2022-07-24T16:06:18+08:00">2022-07-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><h4 id="RN-app-提示bundle-url错误"><a href="#RN-app-提示bundle-url错误" class="headerlink" title="RN app 提示bundle url错误"></a>RN app 提示bundle url错误</h4><blockquote>
<p>我的电脑8081端口被不知名应用占用了。<br>RCTBundlerURLProvider 默认是8081 定义在kRCTBundleURLProviderDefaultPort<br>使用下面接口判断metro是否启动<br><a target="_blank" rel="noopener" href="http://localhost:8081/status">http://localhost:8081/status</a><br>所以报错没有设置地址</p>
<p>可以建一个ip.txt文件放mainbundle下, 写入 “127.0.0.1:8082”<br><img src="/imgs/xcode_rn_debugip.webp"></p>
</blockquote>
<h4 id="RN-import-错误"><a href="#RN-import-错误" class="headerlink" title="RN import 错误"></a>RN import 错误</h4><blockquote>
<p>jsx 后缀无法识别，被识别成目录了，需要改为js<br>error: Error: Unable to resolve module .&#x2F;src&#x2F;04_State&#x2F;App.jsx<br>“import App from ‘.&#x2F;src&#x2F;04_State&#x2F;App.jsx’;”<br>因为这个模块有一个文件是tsx类型？</p>
</blockquote>
<h4 id="fetch-函数-请求接口有缓存"><a href="#fetch-函数-请求接口有缓存" class="headerlink" title="fetch 函数 请求接口有缓存"></a>fetch 函数 请求接口有缓存</h4><p>应该有参数禁用缓存，实际开发中缓存用的不多，都需要实时数据。</p>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><h4 id="js-函数参数里的大括号是什么意思？-gt"><a href="#js-函数参数里的大括号是什么意思？-gt" class="headerlink" title="js 函数参数里的大括号是什么意思？ -&gt;"></a>js 函数参数里的大括号是什么意思？ <a target="_blank" rel="noopener" href="https://segmentfault.com/q/1010000017062649">-&gt;</a></h4><p>function Category({category}){}<br>简单的es6 解构语法。 好处是：方便扩展, 可以只取需要的内容，不用考虑参数顺序。</p>
<h4 id="RCTBridge怎么复用？"><a href="#RCTBridge怎么复用？" class="headerlink" title="RCTBridge怎么复用？"></a>RCTBridge怎么复用？</h4><p>对于原生app内嵌RN，每个页面初始化一个新RCTBridge的实例<br>通过预先加载基础包实现页面加速，并缓存bridge实例<br>以前我以为整个app可以复用一个bridge，这会导致bridge里的js代码会增加<br>好处是可以方便的复用数据。纯RN app不就是只有一个bridge嘛</p>
<h4 id="vim-对ts-amp-js的支持"><a href="#vim-对ts-amp-js的支持" class="headerlink" title="vim 对ts&amp;js的支持"></a>vim 对ts&amp;js的支持</h4><p>vim 对js和ts有补全和格式提示<br>ALE提供的格式, lint功能<br>YouCompleteMe提供的补全功能</p>
<h4 id="react-query"><a href="#react-query" class="headerlink" title="react-query"></a><a target="_blank" rel="noopener" href="https://tanstack.com/query/v4/docs/overview">react-query</a></h4><p>又一个大型库要了解<br>React Query is often described as the missing data-fetching library for React, but in more technical terms, it makes fetching, caching, synchronizing and updating server state in your React applications a breeze.</p>
<h4 id="yarn和npm不能混用"><a href="#yarn和npm不能混用" class="headerlink" title="yarn和npm不能混用"></a>yarn和npm不能混用</h4><p>安装一个js库，会引出一堆dependency conflict err<br>是我错了，项目使用的是yarn。我用npm就会报上面错误。</p>
<h4 id="react-native-reanimated"><a href="#react-native-reanimated" class="headerlink" title="react-native-reanimated"></a>react-native-reanimated</h4><p>react-native-reanimated demo 运行报错了，我没有改demo代码。目前没有能力和时间深究。<br><img src="/imgs/rn_reanimated_err.webp"></p>
<h4 id="SafeArea"><a href="#SafeArea" class="headerlink" title="SafeArea"></a>SafeArea</h4><blockquote>
<p>react-native 中 SafeAreaView 和 react-native-safe-area-context的区别。 <a target="_blank" rel="noopener" href="https://stackoverflow.com/a/61887662">-&gt;</a></p>
</blockquote>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>今日工作(都无法完成)</p>
<ol>
<li>学习常用第三方库使用</li>
<li>安卓集成RN(不是重点工作)</li>
<li>RN拆包(不是重点工作)<br>上面任务其实都很复杂，需要做更细的任务拆分。</li>
</ol>
<p>项目中的RN将是我一个人负责。全部是我一个人负责。以后公司的RN可能都是我负责。<br>还要培训其他同事。需求还不少。对我来说是个挑战。有趣的挑战。</p>
<p>我们组今日来了一个妹子。还在招人。计划14-16人。<br>下午对面一个同事收拾好了电脑。不知道是做什么的。</p>
<p>只是完成需求，不是难事。任何能写程序的人，花点时间都很做。所以一个程序员的价值在哪呢？肯定不是做需求。应该专注于细节（原理），又专注于架构。最终能写出更优秀的代码。有次面试，我说我的长处是又快又好的做页面。被面试官鄙视了。回头想想，我是真傻。其实我会的东西很多，只不知道怎么表达。没错，就是去年的事情。</p>
<p>程序员懂得再多也是无用的，除非有家公司正好急缺某方面的“人才”，才有可能找到工作。<br>我面试岗位是iOS的开发，入职后让我开发ReactNative。只因为我有过相关的经验。<br>领导的意思是一个模块都用ReactNative开发，不需要和原生代码交互。也就是我以前的大部分经验都用不上了。<br>所以爱奇艺的招聘手册上赫然写着：过往的经验只六月有效。细思极恐。</p>
<p>react-native-reanimated为例，只是参考demo实现页面是很容易的。<br>但每一个api有什么用途，为什么这样设计，是需要深入学习的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/11/work-daily-220711/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/11/work-daily-220711/" class="post-title-link" itemprop="url">work_daily_220711</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-11 09:33:36" itemprop="dateCreated datePublished" datetime="2022-07-11T09:33:36+08:00">2022-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-24 16:06:18" itemprop="dateModified" datetime="2022-07-24T16:06:18+08:00">2022-07-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><h4 id="RN打包静态库"><a href="#RN打包静态库" class="headerlink" title="RN打包静态库"></a>RN打包静态库</h4><blockquote>
<p>查看依赖的命令，下面是同一个命令<br>npx react-native config<br>node &#x2F;Users&#x2F;dengjinlong&#x2F;Documents&#x2F;1-rn&#x2F;AwesomeProject&#x2F;node_modules&#x2F;@react-native-community&#x2F;cli&#x2F;build&#x2F;bin.js config</p>
<p>需要写一个脚本把header拷贝到项目中<br>获取xcode环境变量 (勾选show environment variables), 也可以使用xcodebuild<br><img src="/imgs/xcode_show_env_var.webp"><br>需要一个脚本把link library 填上，因为pod不会自动合成静态库，需要手动link</p>
<p>rn集成flipper工具时有两个动态库的依赖。glog &amp;  OpenSSL<br>而且静态库包体积增加了200M，包含了多个arch代码</p>
</blockquote>
<h4 id="RN-lint-经常报奇怪的错误"><a href="#RN-lint-经常报奇怪的错误" class="headerlink" title="RN lint 经常报奇怪的错误"></a>RN lint 经常报奇怪的错误</h4><p>因为后缀名不能错，必须要是jsx或tsx</p>
<h4 id="react-native-classroom"><a href="#react-native-classroom" class="headerlink" title="react-native-classroom"></a>react-native-classroom</h4><blockquote>
<p>下载了极客时间的RN项目react-native-classroom，无法运行起来。<br>这个项目包含常用的第三方库和最佳实践。</p>
<p>Codegen编译错误<br><img src="/imgs/xcode_rn_React-Codegen_build_err.webp"></p>
<p>参考官方0.69工程，发现codegen生成的代码有问题。把多余代码删除了。<br>然后react-native-flipper编译报错。调试用的。删掉，然后可以运行了。</p>
</blockquote>
<blockquote>
<p>react-native-classroom使用的依赖</p>
</blockquote>
<pre><code>&quot;graphql&quot;
&quot;@apollo/client&quot;  A fully-featured caching GraphQL client.
&quot;apollo3-cache-persist&quot;   Simple persistence for all Apollo cache implementations
&quot;@react-native-async-storage/async-storage&quot;   Asynchronous, persistent, key-value storage system for React Native.
&quot;@react-native-masked-view/masked-view&quot;   在组件上添加模板
&quot;@react-navigation/*&quot;     导航
&quot;react-native-screens&quot;   和react-navigation 什么关系？https://reactnavigation.org/docs/2.x/react-native-screens/
&quot;@sentry/react-native&quot;   统计
&quot;axios&quot;   Promise based HTTP client for the browser and node.js
&quot;color&quot;    Color conversion and manipulation with CSS string support
&quot;expo&quot;   The Expo SDK
&quot;expo-blur&quot;  A component that renders a native blur view on iOS and falls back to a semi-transparent view on Android. A common usage of this is for navigation bars, tab bars, and modals.
&quot;expo-modules-core&quot; The core of Expo Modules architecture
&quot;expo-status-bar&quot; Provides the same interface as the React Native StatusBar API, but with slightly different defaults to work great in Expo environments.
&quot;faker&quot;   Generate massive amounts of fake contextual data
&quot;miragejs&quot;  A client-side server to help you build, test and demo your JavaScript app
&quot;react&quot;
&quot;react-native&quot;
&quot;react-native-code-push&quot;
&quot;react-native-device-info&quot;
&quot;react-native-echarts-wrapper&quot;
&quot;react-native-gesture-handler&quot;
&quot;react-native-mmkv&quot;
&quot;react-native-pager-view&quot;
&quot;react-native-paper&quot;
&quot;react-native-reanimated&quot;
&quot;react-native-safe-area-context&quot;
&quot;react-native-tab-view&quot;
&quot;react-native-uuid&quot;
&quot;react-native-vector-icons&quot;
&quot;react-native-webview&quot;
&quot;react-query&quot;
&quot;recyclerlistview&quot;
&quot;mobx&quot;   Simple, scalable state management.
&quot;@reduxjs/toolkit&quot;   The official, opinionated, batteries-included toolset for efficient Redux development
&quot;react-redux&quot;
&quot;redux&quot;
&quot;seedrandom&quot;
&quot;parse-link-header&quot;   Parses a link header and returns paging information for each contained link.
&quot;querystring&quot;  Parse and stringify URL query strings
&quot;url&quot;
&quot;xtend&quot; Extend like a boss
</code></pre>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><p>RN 使用 auto-linking 安装 native 依赖 <a target="_blank" rel="noopener" href="https://github.com/react-native-community/cli/blob/main/docs/autolinking.md">-&gt;</a></p>
<p>消除xcode中很多奇怪日志 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/37800790/hide-strange-unwanted-xcode-logs">-&gt;</a></p>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>今天工作内容</p>
<ol>
<li>完成脚本编写，自动打包静态库</li>
<li>Typescript 入门</li>
<li>集成react到项目中</li>
</ol>
<p>项目目标是公司的rn移动平台</p>
<p>下载了Flipper调试工具，又要学一个新软件。体验了一下，还不如chrome。项目停滞了一样。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/08/work-daily-220708/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/08/work-daily-220708/" class="post-title-link" itemprop="url">work_daily_220708</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-08 09:33:36" itemprop="dateCreated datePublished" datetime="2022-07-08T09:33:36+08:00">2022-07-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-31 07:26:09" itemprop="dateModified" datetime="2022-07-31T07:26:09+08:00">2022-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="技术踩坑"><a href="#技术踩坑" class="headerlink" title="技术踩坑"></a>技术踩坑</h3><h4 id="首次运行主工程"><a href="#首次运行主工程" class="headerlink" title="首次运行主工程"></a>首次运行主工程</h4><p>没有技术文档，刚从深圳转过来的项目，技术栈：swift+flutter+vue，也是历尽坎坷才运行起来</p>
<blockquote>
<p>通过pod安装flutter和第三方库<br>使用了<a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/xcode/adding-package-dependencies-to-your-app">swift package dependences</a><br>xcode 右键可以出菜单<br><img src="/imgs/xcode-swift-package-dependencies.webp" alt="xcode 右键可以出菜单"></p>
<p>update package 时出错<br>“Package.resolved file is corrupted or malformed; fix or delete the file to continue: unsupported schema version 2”<br><img src="/imgs/xcode-swift-update-error.webp" alt="update package 时出错"></p>
<p>打开swiftpm目录，删除原来的resolved文件<br><img src="/imgs/xode-swift-pm-folder.webp" alt="swiftpm目录"></p>
<p>依赖关系查看<br><img src="/imgs/xode-swift-dependencies-info.webp" alt="依赖关系查看"></p>
<p>swift package内部项目依赖 没有权限无法拉取<br>外网项目依赖，可能需要github账号<br><img src="/imgs/xode-sourcecontrol-account.webp" alt="添加account"></p>
<p>运行提示错误<br><img src="/imgs/xode-launch-error.webp"><br>网上说是“证书问题，真机调试 targets的证书都必须是开发证书，若是ADHOC的证书会出现此问题。”</p>
<p>还是遇到开发者账号满员问题<br>同事误给了个adhoc证书，无法运行。我们觉得应该加开发者账号。<br>然而同事给了我们新的开发证书<br>Signing Certificate 是 apple develement证书, 后缀cer文件<br>provisioning profile 是 后缀mobileprovision 文件</p>
<p>项目用了dyframework，启动很慢，需要优化</p>
<p>flutter 编译突然报错了, 重新更新一下flutter就好了<br><img src="/imgs/xcode_flutter_script_build_error.webp"></p>
</blockquote>
<h4 id="RN任务"><a href="#RN任务" class="headerlink" title="RN任务"></a>RN任务</h4><p>第一个任务是 使用RN做一个模块，月底上线！！！我着手准备下面的事项</p>
<blockquote>
<ol>
<li>打开官网安装一下开发环境，看看文档压压惊<br>不需要安装react-natvie-cli了，直接使用npm中的npx命令 <a target="_blank" rel="noopener" href="http://nodejs.cn/learn/the-npx-nodejs-package-runner">-&gt;</a><br>rn pod 依赖配置 需要关注一下 <a target="_blank" rel="noopener" href="https://reactnative.dev/docs/integration-with-existing-apps#configuring-cocoapods-dependencies">-&gt;</a></li>
<li>ios,android集成<ul>
<li>了解各依赖的用途，看是否要裁剪</li>
<li>release&amp;debug两种集成方法，RN debug工具太重依赖太多</li>
<li>rn打包封装成一个script node_modules&#x2F;react-native&#x2F;scripts&#x2F;react_native_pods 叫 autolink</li>
<li>打包静态库试验<blockquote>
<p>CRN 携程开源的项目，把所有需要的文件集成在一起了。也就无法升级了。<br>我计划是在RN的模板工程之上脚本打包出静态framework<br>直接在iOS工程里新建一个framework可以打包出动态库，但无法打包出静态库。<br>Linking-&gt;mach-o type 切换动态库和静态库<br>静态库使用libtool, 没有自动添加 -l参数，需要手动添加到 Link Binary With Libraries<br>头文件没有找到，需要添加header search path<br>  <img src="/imgs/rn_static_framework_header_not_found.webp"></p>
</blockquote>
</li>
</ul>
</li>
<li>工程化(突然想到的，是什么意思呢)</li>
<li>Metro分包热更</li>
<li>typescript</li>
<li>成熟的第三方库有哪些</li>
</ol>
</blockquote>
<h3 id="不懂就问"><a href="#不懂就问" class="headerlink" title="不懂就问"></a>不懂就问</h3><h4 id="xcode打开大json，导致卡死"><a href="#xcode打开大json，导致卡死" class="headerlink" title="xcode打开大json，导致卡死"></a>xcode打开大json，导致卡死</h4><p>force quit 后再次开启，默认上次打开的json文件，然后卡死。<br>解决方法：先从终端把json文件删除了。打开xcode，打开其他文件。再也不要在xcode里打开json了。<br>为什么会这样呢？</p>
<h4 id="RN-flipper-是什么"><a href="#RN-flipper-是什么" class="headerlink" title="RN flipper 是什么"></a><a target="_blank" rel="noopener" href="http://reactnative.dev/blog/2020/03/26/version-0.62">RN flipper</a> 是什么</h4><p>Flipper is a developer tool for debugging mobile apps. It’s popular in the Android and iOS communities, and in this release we’ve enabled support by default for new and existing React Native apps.</p>
<h3 id="想啥写啥"><a href="#想啥写啥" class="headerlink" title="想啥写啥"></a>想啥写啥</h3><p>7月7日 入职, 在这个大环境下，降薪求稳，是正确的选择</p>
<h4 id="第一次晨会"><a href="#第一次晨会" class="headerlink" title="第一次晨会"></a>第一次晨会</h4><p>领导和我们开了个小会，传达几个要点</p>
<ol>
<li>产品给老板用，压力大，需要注重质量</li>
<li>需要支持快速发版，使用RN替换部分flutter</li>
<li>需求较多，还在招人中</li>
<li>全栈开发。演变过程：原生-&gt;Vue-&gt;Flutter-&gt;RN</li>
<li>有事找产品经理，产品经理兼任项目经理</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/07/others-blog-startup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/07/others-blog-startup/" class="post-title-link" itemprop="url">今日，扬帆起航</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-07 17:06:02" itemprop="dateCreated datePublished" datetime="2022-07-07T17:06:02+08:00">2022-07-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-17 08:36:48" itemprop="dateModified" datetime="2022-07-17T08:36:48+08:00">2022-07-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/work/" itemprop="url" rel="index"><span itemprop="name">工作日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>坚持写文章的真不多。即使是牛人，年轻时写几篇高质量的文章，混个大厂门票。然后写的就越来越少。</p>
<p>可能年纪大了，时间花在家庭上和更赚钱的事上；可能值钱的事情不好分享出来，除了广告。 我关注过的一个iOS大牛，微信公众号也只发广告了。可能去做视频up主了，希望获取关注，也是为了发广告。从博客、微博、微信公众号到短视频，所有创作的目的也是为了获取流量。只有持续的创作高质量的内容才可能获得广告收益。普通人就凑个热闹。</p>
<p>录音机，电视机，电脑，平板出现很多年了，书籍消失了吗？我工作一直用电脑又看书少，但是看了不少技术文档。书做为一种娱乐工具，基本被替代电子产品和软件替代了。书做为学术或知识载体，是没有被替代的。电子书也是书嘛。</p>
<p>我想说的是写博客就没有价值了吗？该不该去录短视频？我觉得写博客是有价值的，可以写一个字表示心情，可以写一段话表示思考，可以写一篇文章介绍一些技术。写得多了，也就积累多了，可以集合成书。书可以在网络分享，给需要学习的人。学习知识始终是以看书为主的。</p>
<p>当然写作不可一蹴而就，那先从日记开始，记录工作问题和所思所想。然后对日常的问题进行研究，变成学习记录。最后整理成独创的文章进行知识分享。</p>
<p>所以我的blog分为了下面几类：</p>
<ul>
<li>生活日记(daily)  个人生活记录</li>
<li>工作日记(work)  工作相关的记录，工作的思考，奇葩bug等</li>
<li>学习记录(study)  对针工作日记中问题和知识，进行思考和学习的过程</li>
<li>知识分享(share)  把学习记录整合成系列的知识，分享出去</li>
</ul>
<p>我不看热搜，那些基本是新闻或娱乐。手机游戏删了，短视频也删了，就差删微信。支付宝也不开了。用微信支付启动还是慢了，想要更快的启动方式，只用来支付就好了。网购也少了，有需要才开app。今后的我要花更多时间在工作和写作上，提升技术水平，提升工作能力，提升个人综合素质。最后不忘锻炼身体。</p>
<p>曾经的我定下各种成长计划，各种人生目标。满怀梦想，充满斗志。<br>如今的我看清现实了，没有斗志但有生活的压力，让我继续奋斗。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://dengcqw.github.io/2022/07/01/life-daily-220701-visit-zoo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="DengJinlong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deng's Technique Blogs">
      <meta itemprop="description" content="我也有个写作的梦想，还有大把时间，努力实现吧。I also have a dream about writing. A mount of time in the feature, it's never too late.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Deng's Technique Blogs">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/01/life-daily-220701-visit-zoo/" class="post-title-link" itemprop="url">带小孩和老妈游览上海动物园</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-01 20:24:26" itemprop="dateCreated datePublished" datetime="2022-07-01T20:24:26+08:00">2022-07-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-08-14 18:18:12" itemprop="dateModified" datetime="2022-08-14T18:18:12+08:00">2022-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/life/" itemprop="url" rel="index"><span itemprop="name">生活日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>上海解封一个月了，我第一次出远门。带小孩和老妈来逛动物园。<br>看到草坪在阳光下很美丽就拍了几张照片，留作纪念。<br>二来测试一下github里存放的图片能不能展示。</p>
<p><img src="/imgs/daily_zoo_grassland_1.webp" alt="草坪" title="草坪"></p>
<p>今天收到正式offer。对于我来说简直是天大的喜讯。<br>收入远不如前了，但是离家近了。我又有时间可以重新开始了。<br>我需要改变以往粗放的学习模式，好好思考和总结。<br>我一直认为写程序是一门手艺，可以一辈子吃饭的手艺， 而不是35岁就必然失业。<br>写程序更是一种爱好，一种修炼。<br>我是不会放弃的。<br>今年我35岁。</p>
<p><img src="/imgs/daily_zoo_grassland_2.webp" alt="草坪" title="草坪"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DengJinlong</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
